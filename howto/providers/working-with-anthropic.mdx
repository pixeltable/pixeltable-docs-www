---
title: "Working with Anthropic in Pixeltable"
sidebarTitle: "Anthropic"
icon: "notebook"
---
<a href="https://kaggle.com/kernels/welcome?src=https://github.com/pixeltable/pixeltable/blob/release/docs/release/howto/providers/working-with-anthropic.ipynb" id="openKaggle" target="_blank" rel="noopener noreferrer"><img src="https://kaggle.com/static/images/open-in-kaggle.svg" alt="Open in Kaggle" style={{ display: 'inline', margin: '0px' }} noZoom /></a>&nbsp;&nbsp;<a href="https://colab.research.google.com/github/pixeltable/pixeltable/blob/release/docs/release/howto/providers/working-with-anthropic.ipynb" id="openColab" target="_blank" rel="noopener noreferrer"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open in Colab" style={{ display: 'inline', margin: '0px' }} noZoom /></a>&nbsp;&nbsp;<a href="https://raw.githubusercontent.com/pixeltable/pixeltable/refs/tags/release/docs/release/howto/providers/working-with-anthropic.ipynb" id="downloadNotebook" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/badge/%E2%AC%87-Download%20Notebook-blue" alt="Download Notebook" style={{ display: 'inline', margin: '0px' }} noZoom /></a>

<Tip>This documentation page is also available as an interactive notebook. You can launch the notebook in
Kaggle or Colab, or download it for use with an IDE or local Jupyter installation, by clicking one of the
above links.</Tip>




export const quartoRawHtml =
[`
<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th">input</th>
<th data-quarto-table-cell-role="th">response</th>
</tr>
</thead>
<tbody>
<tr>
<td style="vertical-align: middle;">What was the outcome of the 1904 US Presidential election?</td>
<td style="vertical-align: middle;"># 1904 US Presidential Election **Winner: Theodore Roosevelt
(Republican)** ## Key Results: - **Roosevelt**: 336 electoral votes,
56.4% of popular vote (~7.6 million votes) - **Alton B. Parker**
(Democrat): 140 electoral votes, 37.6% of popular vote (~5.1 million
votes) - **Eugene V. Debs** (Socialist): 402,283 popular votes (3.3%) ##
Significance: - Roosevelt won decisively and in his own right (he had
assumed the presidency in 1901 after McKinley's assassination) - His
victory gave him a strong mandate to pursue his progressive policies -
He remained in office through 1909, becoming one of the most influential
presidents of the early 20th century - Parker's poor showing reflected
the Democrats' weakness during this period and the popularity of
Roosevelt's "Square Deal" domestic policies and assertive foreign policy
The election is often remembered as a landslide victory that validated
Roosevelt's presidency and the Progressive movement's growing influence
in American politics.</td>
</tr>
</tbody>
</table>
`];

Pixeltable’s Anthropic integration enables you to access Anthropic’s
Claude LLM via the Anthropic API.

### Prerequisites

-   An Anthropic account with an API key
    (https://docs.anthropic.com/en/api/getting-started)

### Important notes

-   Anthropic usage may incur costs based on your Anthropic plan.
-   Be mindful of sensitive data and consider security measures when
    integrating with external services.

First you’ll need to install required libraries and enter an Anthropic
API key.


```python
%pip install -qU pixeltable anthropic
```


```python
import getpass
import os

if 'ANTHROPIC_API_KEY' not in os.environ:
    os.environ['ANTHROPIC_API_KEY'] = getpass.getpass(
        'Anthropic API Key:'
    )
```

Now let’s create a Pixeltable directory to hold the tables for our demo.


```python
import pixeltable as pxt

# Remove the 'anthropic_demo' directory and its contents, if it exists
pxt.drop_dir('anthropic_demo', force=True)
pxt.create_dir('anthropic_demo')
```

<pre style={{ 'margin': '-20px 20px 0px 20px', 'padding': '0px', 'background-color': 'transparent', 'color': 'black' }}>
Created&nbsp;directory&nbsp;&#x27;anthropic_demo&#x27;.
&lt;pixeltable.catalog.dir.Dir&nbsp;at&nbsp;0x3149b2b10&gt;
</pre>

## Messages

Create a Table: In Pixeltable, create a table with columns to represent
your input data and the columns where you want to store the results from
Anthropic.


```python
from pixeltable.functions import anthropic

# Create a table in Pixeltable and add a computed column that calls Anthropic

t = pxt.create_table('anthropic_demo/chat', {'input': pxt.String})

msgs = [{'role': 'user', 'content': t.input}]
t.add_computed_column(
    output=anthropic.messages(
        messages=msgs,
        model='claude-haiku-4-5-20251001',
        max_tokens=300,
        model_kwargs={
            # Optional dict with parameters for the Anthropic API
            'system': 'Respond to the prompt with detailed historical information.',
            'temperature': 0.7,
        },
    )
)
```

<pre style={{ 'margin': '-20px 20px 0px 20px', 'padding': '0px', 'background-color': 'transparent', 'color': 'black' }}>
Created&nbsp;table&nbsp;&#x27;chat&#x27;.
Added&nbsp;0&nbsp;column&nbsp;values&nbsp;with&nbsp;0&nbsp;errors.
No&nbsp;rows&nbsp;affected.
</pre>


```python
# Parse the response into a new column
t.add_computed_column(response=t.output.content[0].text)
```

<pre style={{ 'margin': '-20px 20px 0px 20px', 'padding': '0px', 'background-color': 'transparent', 'color': 'black' }}>
Added&nbsp;0&nbsp;column&nbsp;values&nbsp;with&nbsp;0&nbsp;errors.
No&nbsp;rows&nbsp;affected.
</pre>


```python
# Start a conversation
t.insert(
    [
        {
            'input': 'What was the outcome of the 1904 US Presidential election?'
        }
    ]
)
t.select(t.input, t.response).show()
```

<pre style={{ 'margin': '-20px 20px 0px 20px', 'padding': '0px', 'background-color': 'transparent', 'color': 'black' }}>
Inserting&nbsp;rows&nbsp;into&nbsp;\`chat\`:&nbsp;1&nbsp;rows&nbsp;\[00:00,&nbsp;203.87&nbsp;rows/s\]
Inserted&nbsp;1&nbsp;row&nbsp;with&nbsp;0&nbsp;errors.
</pre>

<div style={{ 'margin': '0px 20px 0px 20px' }} dangerouslySetInnerHTML={{ __html: quartoRawHtml[0] }} />

### Learn More

To learn more about advanced techniques like RAG operations in
Pixeltable, check out the [RAG Operations in
Pixeltable](/howto/use-cases/rag-operations)
tutorial.

If you have any questions, don’t hesitate to reach out.
